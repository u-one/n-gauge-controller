# Nゲージコントローラー配線図

## Arduino UNO + L298N モータードライバ配線図

```
                          L298N モータードライバ
                    ┌─────────────────────────────────┐
                    │                                 │
                    │  ┌───┐  ┌───┐     ┌───┐  ┌───┐  │
                    │  │OUT│  │OUT│     │OUT│  │OUT│  │
                    │  │ 1 │  │ 2 │     │ 3 │  │ 4 │  │
                    │  └─┬─┘  └─┬─┘     └─┬─┘  └─┬─┘  │
                    │    │      │         │      │    │
                    └────┼──────┼─────────┼──────┼────┘
                         │      │         │      │
                         │      │         │      │
                    ┌────▼──────▼────┐    │      │
                    │                │    │      │
                    │   Nゲージ      │    │      │  (未使用)
                    │   レール       │    │      │
                    │   (モーター)    │    │      │
                    └─────────────────┘    │      │
                                          │      │
                                          ▼      ▼


Arduino UNO                           L298N ピン配置
┌─────────────────┐                   ┌─────────────────────────┐
│                 │                   │                         │
│    DIGITAL      │                   │ ENA IN1 IN2 IN3 IN4 ENB │
│                 │                   │  ▲   ▲   ▲   x   x   x  │
│  13 ○           │                   │  │   │   │              │
│  12 ○           │                   │  │   │   │              │
│  11 ○           │                   │  │   │   │              │
│  10 ○───────────┼───────────────────┼──┘   │   │              │
│   9 ○───────────┼───────────────────┼──────┼───┘              │
│   8 ○───────────┼───────────────────┼──────┘                  │
│   7 ○           │                   │                         │
│   6 ○           │                   │                         │
│   5 ○           │                   │                         │
│   4 ○           │                   │                         │
│   3 ○           │                   │                         │
│   2 ○           │                   │                         │
│   1 ○           │                   │    12V   GND   5V       │
│   0 ○           │                   │     ▲     ▲     ▲       │
│                 │                   └─────┼─────┼─────┼───────┘
│  5V ○───────────┼─────────────────────────┼─────┼─────┘
│ GND ○───────────┼─────────────────────────┼─────┼
│ VIN ○           │                         │     │            
│                 │                         │     │            
│    POWER        │                ┌────────┘     └───────────┐
│                 │                │                          │
│    ANALOG       │                │  ┌─────────────────────┐ │
│                 │                │  │                     │ │
│  A5 ○           │                │  │   外部電源           │ │
│  A4 ○           │                │  │   (12V 2A)          │ │
│  A3 ○           │                │  │                     │ │
│  A2 ○           │                │  │   +12V   GND        │ │
│  A1 ○           │                │  │     ▲     ▲         │ │
│  A0 ○           │                │  └─────┼─────┼─────────┘ │
│                 │                │        │     │           │
└─────────────────┘                └────────┘     └───────────┘
```

## 接続一覧表

| Arduino UNO | L298N | 説明 |
|-------------|-------|------|
| D8          | IN1   | モーター制御信号1 |
| D9          | IN2   | モーター制御信号2 |
| D10 (PWM)   | ENA   | PWM速度制御 |
| 5V          | 5V    | ロジック電源 |
| GND         | GND   | 共通グランド |
| -           | 12V   | 外部電源（12V） |
| -           | OUT1  | レール/モーター+ |
| -           | OUT2  | レール/モーター- |

## 重要な注意事項

1. **外部電源**: L298Nの12V端子には必ず外部電源（12V 2A推奨）を接続
2. **共通GND**: Arduino、L298N、外部電源のGNDは必ず共通接続
3. **5V-ENジャンパー**: L298Nの5V-ENジャンパーはそのまま（取り外し不要）
4. **PWMピン**: Arduino D10はPWM対応ピンを使用
5. **電流容量**: モーターの消費電流に応じて適切な外部電源を選択

## 動作確認手順

1. 配線完了後、外部電源を接続する前にもう一度配線を確認
2. Arduinoにプログラムをアップロード
3. 外部電源を接続
4. シリアルモニターで動作確認